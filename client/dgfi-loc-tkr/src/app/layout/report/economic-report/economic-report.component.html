<form [formGroup]="economicFrom" class="p-3 rounded shadow-sm bg-light">
  <h5 class="text-primary mb-4">তথ্য অনুসন্ধান করুন</h5>

  <div class="row align-items-center mb-3">
    <div class="col-auto">
      <label for="ty" class="form-label fw-bold mb-0">ধরন:</label>

      <!-- <div class=""> -->
      <select class="form-select form-select-sm mx-1" id="ty" [value]="typeOfForm()"
        (change)="changeType($any($event.target)?.value)">
        <option value="null">-- নির্বাচন করুন --</option>
        @for (ty of _types; track ty.id) {
        <option [value]="ty.value">{{ ty.name }}</option>
        }
      </select>
      <!-- </div> -->
    </div>
  </div>
  @if(typeOfForm()){

  <div class="row">
    @if(typeOfForm() == 'PRODUCTS'){

    <div class="col-auto">
      <div class="text-primary mb-2">পণ্যের নাম:</div>
      <div formArrayName="idProductNameList" class="row g-1">
        @for (product of productsName(); track product.configId; let i = $index) {
        <div class="col-auto">
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" [value]="product.configId"
              [id]="'product_' + product.configId" (change)="onCrimeTypeChange($event, product.configId)">
            <label class="form-check-label small" [for]="'product_' + product.configId">
              {{product.value1}}
            </label>
          </div>
        </div>
        }
      </div>

    </div>
    }
  </div>

  <div class="row g-2">
    <div class="col-md-6">
      <label for="dateRange" class="form-label small fw-bold mb-1">সময়সীমা: <sup class="text-danger">*</sup></label>
      <input type="text" class="form-control form-control-sm" id="dateRange" ngxDaterangepickerBootstrap
        [(ngModel)]="selected" name="daterange" [locale]="local" placeholder="তারিখ নির্বাচন"
        [ngModelOptions]="{standalone: true}" (ngModelChange)="onDateRangeChange($event)" startKey="start" endKey="end"
        autocomplete="off" [closeOnAutoApply]="true" [autoApply]="true" separator=" To " [showDropdowns]="true"
        [ngClass]="{'is-invalid': isSubmitted() && (formDate.invalid || toDate.invalid)}" />
      @if (formDate.invalid || toDate.invalid) {
      <div class="invalid-feedback small">
        সময়সীমা নির্বাচন করুন
      </div>
      }
    </div>

    <div class="col-md-3">
      <label for="compareBy" class="form-label small fw-bold mb-1">সময়ের তুলনা</label>
      <select id="compareBy" class="form-select form-select-sm" formControlName="compareBy">
        <!-- <option value="WEEKLY">সাপ্তাহিক</option> -->
        <option value="MONTHLY">মাসিক</option>
        <option value="YEARLY">বার্ষিক</option>
      </select>
    </div>

    <div class="col-md-3">
      <label for="crt-type" class="form-label small fw-bold mb-1">চার্টের ধরন</label>
      <select id="crt-type" class="form-select form-select-sm" formControlName="chartType">
        @for (type of _chartTypes; track type.value) {
        @if((typeOfForm() != 'PRODUCTS' && type.value != 'pie') || typeOfForm() === 'PRODUCTS'){
        <option [value]="type.value" [selected]="type.value === chartType">
          {{ type.display }}
        </option>
        }
        }
      </select>
    </div>

  </div>
  <div class="text-center mt-3">
    <button type="submit" class="btn btn-primary btn-sm px-4" (click)="onSubmit()">
      খুঁজুন
    </button>
  </div>
  }
</form>

<div class="chart-container">
  <canvas class="mt-4" baseChart id="chart-economic"></canvas>
</div>
@if (isDownload()) {
<button class="btn btn-primary download-btn" (click)="downloadChart()">ডাউনলোড পিডিএফ</button>
}
